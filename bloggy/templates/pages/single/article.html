{% extends "base-with-header-footer.html" %}
{% load static %}
{% load custom_widgets %}
{% load define_action %}
{% load shortcodes_filters %}
{% block base_css_class %}{% endblock base_css_class %}
{% block jsonld %}
    {% include "seo/article_jsonld.html" with author=post.author %}
{% endblock jsonld %}
{% spaceless %}
    {% block content %}
        {% include 'partials/home_article_breadcrumb.html' %}

        <div class="container mt-4">
            <div class="row">
                <main id="main-content" class="hero col-12 col-md-9 col-lg-9 col-print-12 pe-lg-2">
                    <div class="d-flex ">

                        <div class="pr-4">
                            {% categories_widget count=13 content_type="article" widget_style="list" %}
                            {% if user.is_authenticated and user.is_superuser %}
                                <div class="mt-3">
                                    <a class="mt-3 btn btn-sm btn-secondary btn-xs"
                                       href="{{ post.get_admin_url }}">Edit article</a>
                                </div>
                            {% endif %}
                        </div>

                        <div class="flex-grow-1" style="overflow: hidden">
                            <div class="article-details-card ms-md-3 mb-4">
                                {% if post.thumbnail and post.template_type == "cover" %}
                                    <div class="article-single-thumbnails">
                                        <img src="{{ post.thumbnail.url }}" alt="{{ post.title }}"
                                             loading="lazy"/>
                                    </div>
                                {% endif %}


                                <div class="padding-medium relative">
                                        <h1 class="post-title display-2 fw-600 mt-0 mb-2"
                                            style="line-height: 1.2">{{ post.title }}</h1>
                                    <article id="article-content" class="article-content" data-cid="{{ post.id }}"
                                             data-type="{{ post_type }}">

                                        <div class="d-lg-flex justify-content-between align-items-center my-4">
                                            {% include 'partials/article_meta_container.html' with post=post %}
                                            <div id="bookmarkContainer" class="d-none d-md-inline"></div>
                                        </div>

                                        {% if post %}
                                            {% include 'partials/toc_widget.html' %}
                                            <div class="mb-3">
                                                <div id="article-content" class="article-content text-zoomed">
                                                    <div>{{ post.content|expand_media_url }}</div>
                                                </div>
                                                {% include "partials/social_share.html" with object=post authoName=post.author.get_full_name_or_username %}
                                            </div>
                                        {% endif %}
                                    </article>
                                    {% include 'partials/author_widget.html' with author=post.author %}
                                    {% related_article_widget count=10 slug=post.slug categories=post.category.all widget_title='Related articles' widget_style="list" %}
                                </div>

                            </div>

                            <div class="padding-medium article-details-card ms-md-3 mb-4">
                                <section id="vueRoot" class="d-print-none ">
                                    <comments post-id="{{ post.id }}" post-type="{{ post.post_type }}"
                                              current-user="{{ user }}"></comments>
                                </section>
                            </div>
                        </div>
                    </div>
                </main>

                <aside id="right-sidebar" class="col-12 col-md-3 col-lg-3 d-print-none">
                    {% if post.video_id %}
                        <div class="article-details-card p-0">
                            {% with '[youtube=https://www.youtube.com/watch?v='|addstr:post.video_id|addstr:']' as youtubeUrl %}
                                {{ youtubeUrl|shortcodes|safe }}
                            {% endwith %}
                        </div>
                        <div class="pt-2 mb-4">
                            <a href="{{ 'https://www.youtube.com/watch?v='|addstr:post.video_id }}" class="youtube-button" target="_blank">
                                <i class="fa-brands fa-youtube pe-2"></i>Watch on YouTube</a>
                        </div>
                    {% endif %}

                    <div class="sidebar-content" style="z-index: 99">
                        {% include "partials/home_widget_contribute_cta.html" %}
                        {% include 'partials/newsletter.html' %}
                    </div>
                </aside>
            </div>
        </div>


    {% endblock content %}
{% endspaceless %}